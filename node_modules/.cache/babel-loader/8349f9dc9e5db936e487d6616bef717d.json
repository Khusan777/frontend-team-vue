{"remainingRequest":"/Users/admin/Desktop/MyProjects/frontend-team-vue/node_modules/babel-loader/lib/index.js!/Users/admin/Desktop/MyProjects/frontend-team-vue/node_modules/eslint-loader/index.js??ref--13-0!/Users/admin/Desktop/MyProjects/frontend-team-vue/src/services/apiClient.js","dependencies":[{"path":"/Users/admin/Desktop/MyProjects/frontend-team-vue/src/services/apiClient.js","mtime":1651231758529},{"path":"/Users/admin/Desktop/MyProjects/frontend-team-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/MyProjects/frontend-team-vue/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/admin/Desktop/MyProjects/frontend-team-vue/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgeyB0aHJvdHRsZUFkYXB0ZXJFbmhhbmNlciB9IGZyb20gJ2F4aW9zLWV4dGVuc2lvbnMnOwppbXBvcnQgcm91dGVyIGZyb20gJ34vcm91dGVyJzsKaW1wb3J0IHsgcGFyc2VFcnJvcnNGcm9tUmVzcG9uc2UgfSBmcm9tICd+L3V0aWxzL3BhcnNlcnMnOwppbXBvcnQgeyBvYmpDaGVja1R5cGUgfSBmcm9tICd+L3V0aWxzL2NvbXB1dGVGdW5jJzsKaW1wb3J0IHsgYXBwIH0gZnJvbSAnfi9tYWluJzsKaW1wb3J0IFZ1ZUNvb2tpZSBmcm9tICd2dWUtY29va2llJzsKdmFyIHRocm90dGxlQ29uZmlnID0gewogIHRocmVzaG9sZDogMTAwMAp9Owp2YXIgYXBpQ2xpZW50ID0gYXhpb3MuY3JlYXRlKHsKICBiYXNlVVJMOiAiIi5jb25jYXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9CQUNLRU5EX0FQSSwgIi8iKSwKICBoZWFkZXJzOiB7CiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicKICB9LAogIGFkYXB0ZXI6IHRocm90dGxlQWRhcHRlckVuaGFuY2VyKGF4aW9zLmRlZmF1bHRzLmFkYXB0ZXIsIHRocm90dGxlQ29uZmlnKQp9KTsKCnZhciBnZW5lcmF0ZVRvYXN0ZXIgPSBmdW5jdGlvbiBnZW5lcmF0ZVRvYXN0ZXIoZXJyb3JzKSB7CiAgaWYgKGVycm9ycyAmJiBvYmpDaGVja1R5cGUoZXJyb3JzLCAnc3RyaW5nJykpIHsKICAgIHZhciBfYXBwJGNvbmZpZyRnbG9iYWxQcm87CgogICAgKF9hcHAkY29uZmlnJGdsb2JhbFBybyA9IGFwcC5jb25maWcuZ2xvYmFsUHJvcGVydGllcykgPT09IG51bGwgfHwgX2FwcCRjb25maWckZ2xvYmFsUHJvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXBwJGNvbmZpZyRnbG9iYWxQcm8uJHRvYXN0LmVycm9yKGVycm9ycyk7CiAgfSBlbHNlIGlmIChlcnJvcnMgJiYgZXJyb3JzLmxlbmd0aCkgewogICAgZXJyb3JzLmZvckVhY2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgIHZhciBfYXBwJGNvbmZpZyRnbG9iYWxQcm8yOwoKICAgICAgKF9hcHAkY29uZmlnJGdsb2JhbFBybzIgPSBhcHAuY29uZmlnLmdsb2JhbFByb3BlcnRpZXMpID09PSBudWxsIHx8IF9hcHAkY29uZmlnJGdsb2JhbFBybzIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hcHAkY29uZmlnJGdsb2JhbFBybzIuJHRvYXN0LmVycm9yKGVycm9yKTsKICAgIH0pOwogIH0KfTsKCnZhciBjbGVhckNvb2tpZSA9IGZ1bmN0aW9uIGNsZWFyQ29va2llKCkgewogIHZhciBfYXBwJGNvbmZpZyRnbG9iYWxQcm8zOwoKICByZXR1cm4gKF9hcHAkY29uZmlnJGdsb2JhbFBybzMgPSBhcHAuY29uZmlnLmdsb2JhbFByb3BlcnRpZXMpICE9PSBudWxsICYmIF9hcHAkY29uZmlnJGdsb2JhbFBybzMgIT09IHZvaWQgMCAmJiBfYXBwJGNvbmZpZyRnbG9iYWxQcm8zLiRjb29raWUgPyBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICB2YXIgX2FwcCRjb25maWckZ2xvYmFsUHJvNDsKCiAgICB2YXIgJGNvb2tpZSA9IChfYXBwJGNvbmZpZyRnbG9iYWxQcm80ID0gYXBwLmNvbmZpZy5nbG9iYWxQcm9wZXJ0aWVzKSA9PT0gbnVsbCB8fCBfYXBwJGNvbmZpZyRnbG9iYWxQcm80ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXBwJGNvbmZpZyRnbG9iYWxQcm80LiRjb29raWU7CgogICAgdHJ5IHsKICAgICAgJGNvb2tpZS5kZWxldGUoJ2F1dGgnKTsKICAgICAgJGNvb2tpZS5kZWxldGUoJ3Ntcy12ZXJpZnknKTsKICAgICAgJGNvb2tpZS5kZWxldGUoJ3Ntcy12ZXJpZnktcGhvbmUnKTsKICAgICAgJGNvb2tpZS5kZWxldGUoJ3Ntcy12ZXJpZnktcGhvbmUtcHJlZml4Jyk7CiAgICAgICRjb29raWUuZGVsZXRlKCdzbXMtdmVyaWZ5LXJlbWVtYmVyLW1lJyk7CiAgICAgICRjb29raWUuZGVsZXRlKCdzbXMtdmVyaWZ5LXNtcy1hdHRlbXB0cycpOwogICAgICByZXNvbHZlKCk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHJlamVjdChlKTsKICAgIH0KICB9KSA6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBlcnJvciA9ICdbRkVd0J7RiNC40LHQutCwLCDQvdC1INC80L7QttC10Lwg0L/QvtC70YPRh9C40YLRjCDQtNC+0YHRgtGD0L8g0LogYGNvb2tpZWAg0L3QsCDQstCw0YjQtdC8INGD0YHRgtGA0L7QudGB0YLQstC1JzsKICAgIGdlbmVyYXRlVG9hc3RlcihlcnJvcik7CiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwogIH0oKTsKfTsKCnZhciBhdXRoSW50ZXJjZXB0b3IgPSBmdW5jdGlvbiBhdXRoSW50ZXJjZXB0b3IoY29uZmlnKSB7CiAgdmFyIF9hcHAkY29uZmlnJGdsb2JhbFBybzUsIF9hcHAkY29uZmlnJGdsb2JhbFBybzY7CgogIHZhciBhdXRoVG9rZW4gPSAoX2FwcCRjb25maWckZ2xvYmFsUHJvNSA9IGFwcC5jb25maWcuZ2xvYmFsUHJvcGVydGllcykgPT09IG51bGwgfHwgX2FwcCRjb25maWckZ2xvYmFsUHJvNSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9hcHAkY29uZmlnJGdsb2JhbFBybzYgPSBfYXBwJGNvbmZpZyRnbG9iYWxQcm81LiRjb29raWUpID09PSBudWxsIHx8IF9hcHAkY29uZmlnJGdsb2JhbFBybzYgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hcHAkY29uZmlnJGdsb2JhbFBybzYuZ2V0KCdhdXRoJyk7CgogIGlmIChhdXRoVG9rZW4pIHsKICAgIGNvbmZpZy5oZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSBhdXRoVG9rZW47CiAgfQoKICByZXR1cm4gY29uZmlnOwp9OwoKdmFyIGVycm9yU3RhdHVzID0gewogIDQwMDogZnVuY3Rpb24gXygpIHsKICAgIHZhciBfYXBwJGNvbmZpZyRnbG9iYWxQcm83LCBfYXBwJGNvbmZpZyRnbG9iYWxQcm84OwoKICAgIChfYXBwJGNvbmZpZyRnbG9iYWxQcm83ID0gYXBwLmNvbmZpZy5nbG9iYWxQcm9wZXJ0aWVzKSA9PT0gbnVsbCB8fCBfYXBwJGNvbmZpZyRnbG9iYWxQcm83ID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2FwcCRjb25maWckZ2xvYmFsUHJvOCA9IF9hcHAkY29uZmlnJGdsb2JhbFBybzcuJHRvYXN0KSA9PT0gbnVsbCB8fCBfYXBwJGNvbmZpZyRnbG9iYWxQcm84ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXBwJGNvbmZpZyRnbG9iYWxQcm84Lndhcm5pbmcoJ9CU0LDQvdC90YvQtSDQvdC1INC90LDQudC00LXQvdGLJyk7CiAgfSwKICA0MDE6IGZ1bmN0aW9uIF8oKSB7CiAgICBkZWxldGUgYXBpQ2xpZW50LmRlZmF1bHRzLmhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXTsKICAgIFZ1ZUNvb2tpZS5kZWxldGUoJ2F1dGgnKTsKICAgIHJvdXRlci5wdXNoKCcvYXV0aCcpOwogIH0sCiAgLy8gNDA0OiBmdW5jdGlvbiAoKSB7CiAgLy8gICByb3V0ZXIucHVzaCh7IG5hbWU6ICdub3QtZm91bmQnIH0pOwogIC8vIH0sCiAgNDE5OiBmdW5jdGlvbiBfKCkgewogICAgcm91dGVyLmJhY2soKSB8fCByb3V0ZXIucHVzaCgnLycpOwogIH0gLy8gNTAwOiBmdW5jdGlvbiAoKSB7CiAgLy8gICByb3V0ZXIucHVzaCh7IG5hbWU6ICdzZXJ2ZXItZXJyb3InIH0pOwogIC8vIH0sCgp9OwoKdmFyIGVycm9ySW50ZXJjZXB0b3IgPSBmdW5jdGlvbiBlcnJvckludGVyY2VwdG9yKGVycm9yKSB7CiAgdmFyIGVycm9ycyA9IHBhcnNlRXJyb3JzRnJvbVJlc3BvbnNlKGVycm9yKTsKCiAgaWYgKGVycm9yLnJlc3BvbnNlLnN0YXR1cyBpbiBlcnJvclN0YXR1cykgewogICAgZXJyb3JTdGF0dXNbZXJyb3IucmVzcG9uc2Uuc3RhdHVzXSgpOwogIH0gZWxzZSB7CiAgICBnZW5lcmF0ZVRvYXN0ZXIoZXJyb3JzKTsKICB9CgogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7Cn07Cgp2YXIgcmVzcG9uc2VJbnRlcmNlcHRvciA9IGZ1bmN0aW9uIHJlc3BvbnNlSW50ZXJjZXB0b3IocmVzcG9uc2UpIHsKICByZXR1cm4gcmVzcG9uc2U7Cn07CgphcGlDbGllbnQuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShyZXNwb25zZUludGVyY2VwdG9yLCBlcnJvckludGVyY2VwdG9yKTsKYXBpQ2xpZW50LmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShhdXRoSW50ZXJjZXB0b3IpOwpleHBvcnQgeyBhcGlDbGllbnQsIGNsZWFyQ29va2llIH07"},{"version":3,"sources":["/Users/admin/Desktop/MyProjects/frontend-team-vue/src/services/apiClient.js"],"names":["axios","throttleAdapterEnhancer","router","parseErrorsFromResponse","objCheckType","app","VueCookie","throttleConfig","threshold","apiClient","create","baseURL","process","env","VUE_APP_BACKEND_API","headers","Accept","adapter","defaults","generateToaster","errors","config","globalProperties","$toast","error","length","forEach","clearCookie","$cookie","Promise","resolve","reject","delete","e","authInterceptor","authToken","get","errorStatus","warning","push","back","errorInterceptor","response","status","responseInterceptor","interceptors","use","request"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport { throttleAdapterEnhancer } from 'axios-extensions';\r\nimport router from '~/router';\r\nimport { parseErrorsFromResponse } from '~/utils/parsers';\r\nimport { objCheckType } from '~/utils/computeFunc';\r\nimport { app } from '~/main';\r\nimport VueCookie from 'vue-cookie';\r\n\r\nconst throttleConfig = {\r\n  threshold: 1000,\r\n};\r\n\r\nconst apiClient = axios.create({\r\n  baseURL: `${process.env.VUE_APP_BACKEND_API}/`,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n    Accept: 'application/json',\r\n  },\r\n  adapter: throttleAdapterEnhancer(axios.defaults.adapter, throttleConfig),\r\n});\r\n\r\nconst generateToaster = errors => {\r\n  if (errors && objCheckType(errors, 'string')) {\r\n    app.config.globalProperties?.$toast.error(errors);\r\n  } else if (errors && errors.length) {\r\n    errors.forEach(error => {\r\n      app.config.globalProperties?.$toast.error(error);\r\n    });\r\n  }\r\n};\r\n\r\nconst clearCookie = () =>\r\n  app.config.globalProperties?.$cookie\r\n    ? new Promise((resolve, reject) => {\r\n        const $cookie = app.config.globalProperties?.$cookie;\r\n        try {\r\n          $cookie.delete('auth');\r\n          $cookie.delete('sms-verify');\r\n          $cookie.delete('sms-verify-phone');\r\n          $cookie.delete('sms-verify-phone-prefix');\r\n          $cookie.delete('sms-verify-remember-me');\r\n          $cookie.delete('sms-verify-sms-attempts');\r\n          resolve();\r\n        } catch (e) {\r\n          reject(e);\r\n        }\r\n      })\r\n    : (() => {\r\n        const error = '[FE]Ошибка, не можем получить доступ к `cookie` на вашем устройстве';\r\n        generateToaster(error);\r\n        return Promise.reject(error);\r\n      })();\r\n\r\nconst authInterceptor = config => {\r\n  const authToken = app.config.globalProperties?.$cookie?.get('auth');\r\n  if (authToken) {\r\n    config.headers['Authorization'] = authToken;\r\n  }\r\n  return config;\r\n};\r\n\r\nconst errorStatus = {\r\n  400: function () {\r\n    app.config.globalProperties?.$toast?.warning('Данные не найдены');\r\n  },\r\n  401: function () {\r\n    delete apiClient.defaults.headers['Authorization'];\r\n    VueCookie.delete('auth');\r\n    router.push('/auth');\r\n  },\r\n  // 404: function () {\r\n  //   router.push({ name: 'not-found' });\r\n  // },\r\n  419: function () {\r\n    router.back() || router.push('/');\r\n  },\r\n  // 500: function () {\r\n  //   router.push({ name: 'server-error' });\r\n  // },\r\n};\r\n\r\nconst errorInterceptor = error => {\r\n  let errors = parseErrorsFromResponse(error);\r\n  if (error.response.status in errorStatus) {\r\n    errorStatus[error.response.status]();\r\n  } else {\r\n    generateToaster(errors);\r\n  }\r\n  return Promise.reject(error);\r\n};\r\n\r\nconst responseInterceptor = response => response;\r\n\r\napiClient.interceptors.response.use(responseInterceptor, errorInterceptor);\r\napiClient.interceptors.request.use(authInterceptor);\r\n\r\nexport { apiClient, clearCookie };\r\n"]}]}